# -Web-PL-0--backend

包含了PL/0的开发环境，包括编辑器、调试器、编译器。对应的API接口。服务端项目

### 说明

本项目主要是为了配合前端项目，用于实现pl0的编译处理，转换成wasm给前端用于处理，显示pl0代码运行结果；<br>
本项目是我的毕设项目，如果要使用的话，请联系我本人，邮箱如下：

- [qq邮箱:2574381756@qq.com](2574381756@qq.com)
- [Google邮箱:kurt.du.cobain@gmail.com](kurt.du.cobain@gmail.com)

使用方法：

- 首先声明，需要配合另一个仓库中的前端项目使用
- 克隆代码到本地，执行`npm i`，下载所需要的`npm_modules`
- 确认所需要监听的端口号，无误后开始执行`npm start`，启动服务器

## 还未做完，别急

### 进度

- 由于这个readme文档更新于2024/2/24，因此接下来我会以现在这个时间为基准讲述项目进度
  - 2/24: 实现了基本的前后端基本通信，能够实现pl0的编译处理（目前实现了词法分析，语法分析，语义分析，中间代码生成），目标代码生成仍存在一些问题，比如循环语句处理和if-else if-else语句的处理等
  - 3/1: 优化了对while语句的中间代码生成处理；优化了for语句的处理；持续完善了if-elseif-else语句的解析；引入wabt，实现了正确的wasm的生成，返回给前端进行执行
  - 3/11: 新增了js目标代码模式，实现了js和wasm的生成；实现了简单的wasm调试功能（存在异常）；引入webSocket，准备优化调试功能（JS模式下）；
  - 4/7: 经过技术选型，最终选择使用inspector以及webSocket技术实现js调试器功能，主要实现的功能如下：
    1. 实现了Debugger调试类，包含了维护断点信息、代码数据、变量（符号表数据）等等功能，提供了对inspector实例Session的创建以及销毁，同时提供了初始化、继续执行、单步执行的功能；
    2. 实现了webSocket的连接，和服务器的http监听同一端口，监听了前端时间事件，由前端控制调试过程；
    3. 结合引入的语义分析和目标代码生成模块，同时实现了源代码（pl0）和目标代码（JS）的映射表，实现了对符号表的二次处理；
    4. 同时，除了本次调试器的技术选型，还有几种其他的选型方案，如下，供大家学习参考：
       - 纯前端实现，让调试过程整个在前端调试，维护调试状态，服务端只负责提供目标代码以及符号表等编译产物（缺点：前端开销大，同时需要在前端Vuex等其他地方维护数据，比较复杂和冗余）；
       - 后端提供沙盒环境实现，使用node提供的vm模块执行代码并测试，确保安全（缺点：Nodejs内置的inspector调试工具不支持vm环境，同时vm环境不支持断点暂停功能，调试功能实现起来有难度）；
       - 后端使用inspector结合child_process，即利用工作线程执行代码，保证了执行环境的安全，同时确保了不会在暂停调试的时候阻塞主线程（缺点：需要开辟子线程，同时利用inspector和子线程通信，控制调试功能，复杂度稍高）
  - 4/28: 结合前端需求做了多出优化，例如新增了一些关键字的识别以及注释的识别、精准了错误信息的返回和代码的映射关系、优化了语义分析器（对局部变量、多次声明等问题做了错误处理）等；
  - 5/1: 对运算中的括号做了处理，并且优化了不区分大小写的处理；打包进行部署以及测试；
  - 5/3: 解决了部署后存在的一些问题，例如webSocket链接异常等，项目基本内容完成。